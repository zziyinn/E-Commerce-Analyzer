import{_ as H,c as d,a as t,t as o,b as P,n as R,F as I,r as A,d as p,e as k,f as O,w as G,g as B,h as J,u as K,i as v,j as C,o as X,k as Y,l as c}from"./index-Jd6TsP0i.js";import{P as Z}from"./ProductCard-B0q4MI7o.js";function F(){if(typeof window<"u"){const a=window.location.hostname;if(a!=="localhost"&&a!=="127.0.0.1"&&!a.startsWith("192.168."))return""}return"http://localhost:8000"}const f=F();class ${async getPriceTrend(s={}){const{days:h=30,category:i,platform:l}=s,g=new URLSearchParams;g.append("days",h),i&&g.append("category",i),l&&g.append("platform",l);const _=F(),u=await fetch(`${_}/api/analysis/price-trend?${g}`);if(!u.ok)throw new Error(`Failed to get price trend: ${u.statusText}`);return u.json()}async getCategoryDistribution(s=null){const h=new URLSearchParams;s&&h.append("platform",s);const i=`${f}/api/analysis/category-distribution${h.toString()?"?"+h:""}`,l=await fetch(i);if(!l.ok)throw new Error(`Failed to get category distribution: ${l.statusText}`);return l.json()}async getDataQuality(){const s=await fetch(`${f}/api/analysis/data-quality`);if(!s.ok)throw new Error(`Failed to get data quality: ${s.statusText}`);return s.json()}async getCompetitionAnalysis(s={}){const{category:h,platform:i}=s,l=new URLSearchParams;h&&l.append("category",h),i&&l.append("platform",i);const g=`${f}/api/analysis/competition-analysis${l.toString()?"?"+l:""}`,_=await fetch(g);if(!_.ok)throw new Error(`Failed to get competition analysis: ${_.statusText}`);return _.json()}async getBatchAnalysis(s=10){const h=await fetch(`${f}/api/analysis/batch-analysis?limit=${s}`);if(!h.ok)throw new Error(`Failed to get batch analysis: ${h.statusText}`);return h.json()}async getPlatformComparison(){const s=await fetch(`${f}/api/analysis/platform-comparison`);if(!s.ok)throw new Error(`Failed to get platform comparison: ${s.statusText}`);return s.json()}async getAIInsights(s={}){const{limit:h=50,category:i,platform:l}=s,g=new URLSearchParams;g.append("limit",h),i&&g.append("category",i),l&&g.append("platform",l);const _=await fetch(`${f}/api/analysis/ai-insights?${g}`);if(!_.ok)throw new Error(`Failed to get AI insights: ${_.statusText}`);return _.json()}}const w=new $,x={name:"Dashboard",components:{ProductCard:Z},setup(){const a=Y(),s=K(),h="é€‰å“ä¸“å®¶",i=v(null),l=v(null),g=v(null),_=v(null),u=v(null),e=v(!1),b=v(!1),y=C(()=>s.statistics),L=C(()=>s.topProducts),Q=C(()=>s.watchedProducts),N=C(()=>s.compareProducts),q=async()=>{e.value=!0;try{const[r,n,m,W]=await Promise.all([w.getPriceTrend({days:30}).catch(()=>null),w.getCategoryDistribution().catch(()=>null),w.getDataQuality().catch(()=>null),w.getCompetitionAnalysis().catch(()=>null)]);i.value=r,l.value=n,g.value=m,_.value=W}catch(r){console.error("Failed to load analysis data:",r)}finally{e.value=!1}},T=async()=>{b.value=!0;try{const r=await w.getAIInsights({limit:50});u.value=r}catch(r){console.error("Failed to load AI insights:",r),u.value={error:r.message}}finally{b.value=!1}},E=r=>{const n=y.value.totalProducts;return n>0?Math.round(r/n*100):0},S=r=>!s.products||s.products.length===0?0:s.products.filter(n=>r==="high"?n.marginRate>30:r==="medium"?n.marginRate>=10&&n.marginRate<=30:r==="low"?n.marginRate<10:!1).length,j=r=>{const n=y.value.totalProducts,m=S(r);return n>0?Math.round(m/n*100):0},D=r=>!s.products||s.products.length===0?0:s.products.filter(n=>r==="low"?n.competitionScore<30:r==="medium"?n.competitionScore>=30&&n.competitionScore<=70:r==="high"?n.competitionScore>70:!1).length,M=r=>{const n=y.value.totalProducts,m=D(r);return n>0?Math.round(m/n*100):0},U=r=>{a.push(`/products/${r}`)},z=r=>{s.toggleWatch(r)},V=r=>{if(!r)return"";let n=r.replace(/\n/g,"<br>");return n=n.replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>"),n=n.replace(/^(\d+\.\s+.*?)(<br>|$)/gm,"<li>$1</li>"),n=n.replace(/(<li>.*?<\/li>(?:<br>)?)+/g,m=>"<ul>"+m.replace(/<br>/g,"")+"</ul>"),n=n.replace(/###\s+(.*?)(<br>|$)/g,"<h4>$1</h4>"),n};return X(async()=>{s.isInitialized||await s.initialize(),await q(),await T()}),{productStore:s,userName:h,stats:y,topProducts:L,watchedProducts:Q,compareProducts:N,viewProduct:U,toggleWatch:z,getPlatformPercentage:E,getProfitCount:S,getProfitPercentage:j,getCompetitionCount:D,getCompetitionPercentage:M,priceTrend:i,categoryDistribution:l,dataQuality:g,competitionAnalysis:_,aiInsights:u,loadingAnalysis:e,loadingAIInsights:b,loadAIInsights:T,formatAIInsights:V}}},tt={class:"dashboard"},st={class:"strategy-advisor"},it={class:"advisor-header"},ot={class:"advisor-title"},at={class:"advisor-suggestions"},et={class:"suggestion-item"},nt={class:"suggestion-item"},rt={class:"suggestion-item"},ct={class:"page-header"},dt={class:"page-title"},lt={class:"page-subtitle"},ht={class:"statistics-cards"},gt={class:"stats-grid"},_t={class:"stat-card"},ut={class:"stat-content"},pt={class:"stat-value"},mt={class:"stat-label"},vt={class:"stat-card"},yt={class:"stat-content"},ft={class:"stat-value"},bt={class:"stat-label"},wt={class:"stat-card"},Pt={class:"stat-content"},It={class:"stat-value"},At={class:"stat-label"},kt={class:"stat-card"},Ct={class:"stat-content"},Tt={class:"stat-value"},St={class:"stat-label"},Dt={class:"charts-grid"},Rt={class:"chart-card"},Bt={class:"chart-content"},Ft={key:0,class:"loading-state"},Lt={key:1,class:"trend-stats"},Qt={class:"trend-summary"},Nt={class:"summary-item"},qt={class:"summary-value"},Et={class:"summary-item"},jt={class:"summary-value"},Mt={class:"summary-item"},Ut={class:"price-distribution"},zt={class:"dist-label"},Vt={class:"dist-bar"},Wt={class:"dist-count"},Ht={key:2,class:"empty-state"},Ot={class:"chart-card"},Gt={class:"chart-content"},Jt={key:0,class:"loading-state"},Kt={key:1,class:"quality-stats"},Xt={class:"quality-score"},Yt={class:"score-circle"},Zt={class:"score-value"},$t={class:"quality-info"},xt={class:"info-item"},ts={class:"info-value"},ss={class:"info-item"},is={class:"info-value"},os={key:0,class:"quality-issues"},as={class:"issue-label"},es={class:"issue-count"},ns={key:2,class:"empty-state"},rs={class:"chart-card"},cs={class:"chart-content"},ds={key:0,class:"loading-state"},ls={key:1,class:"category-stats"},hs={class:"category-header"},gs={class:"category-name"},_s={class:"category-count"},us={class:"category-bar"},ps={class:"category-details"},ms={class:"category-price"},vs={key:0,class:"category-rating"},ys={key:2,class:"empty-state"},fs={class:"chart-card"},bs={class:"chart-header"},ws={class:"chart-title"},Ps={class:"chart-content"},Is={class:"profit-stats"},As={class:"profit-item"},ks={class:"profit-label"},Cs={class:"profit-bar"},Ts={class:"profit-count"},Ss={class:"profit-badge profit-high-badge"},Ds={class:"profit-item"},Rs={class:"profit-label"},Bs={class:"profit-bar"},Fs={class:"profit-count"},Ls={class:"profit-badge profit-medium-badge"},Qs={class:"profit-item"},Ns={class:"profit-label"},qs={class:"profit-bar"},Es={class:"profit-count"},js={class:"chart-card"},Ms={class:"chart-header"},Us={class:"chart-title"},zs={class:"chart-content"},Vs={class:"competition-stats"},Ws={class:"competition-item"},Hs={class:"competition-label"},Os={class:"competition-bar"},Gs={class:"competition-count"},Js={class:"competition-badge competition-low-badge"},Ks={class:"competition-item"},Xs={class:"competition-label"},Ys={class:"competition-bar"},Zs={class:"competition-count"},$s={class:"competition-badge competition-medium-badge"},xs={class:"competition-item"},ti={class:"competition-label"},si={class:"competition-bar"},ii={class:"competition-count"},oi={class:"competition-badge competition-high-badge"},ai={class:"ai-insights-section"},ei={class:"ai-insights-card"},ni={class:"ai-insights-header"},ri={class:"ai-insights-content"},ci={key:0,class:"loading-state"},di={key:1,class:"error-state"},li={class:"error-message"},hi={key:2,class:"insights-text"},gi=["innerHTML"],_i={key:0,class:"insights-meta"},ui={key:3,class:"empty-state"},pi={class:"recent-products"},mi={class:"section-header"},vi={class:"section-title"},yi={class:"products-grid"};function fi(a,s,h,i,l,g){const _=B("router-link"),u=B("ProductCard");return c(),d("div",tt,[t("div",st,[t("div",it,[s[3]||(s[3]=t("div",{class:"advisor-icon"}," ðŸŽ¯ ",-1)),t("h2",ot,o(a.$t("dashboard.strategyAdvisor.greeting",{name:i.userName})),1)]),t("ul",at,[t("li",et,[s[4]||(s[4]=t("span",{class:"suggestion-icon"},"ðŸ“ˆ",-1)),P(" "+o(a.$t("dashboard.strategyAdvisor.suggestions.categoryTrend")),1)]),t("li",nt,[s[5]||(s[5]=t("span",{class:"suggestion-icon"},"âš ï¸",-1)),P(" "+o(a.$t("dashboard.strategyAdvisor.suggestions.priceAlert")),1)]),t("li",rt,[s[6]||(s[6]=t("span",{class:"suggestion-icon"},"ðŸ’¡",-1)),P(" "+o(a.$t("dashboard.strategyAdvisor.suggestions.searchRecommendation")),1)])])]),t("div",ct,[t("h1",dt,o(a.$t("dashboard.title")),1),t("p",lt,o(a.$t("dashboard.subtitle")),1)]),t("div",ht,[t("div",gt,[t("div",_t,[s[7]||(s[7]=t("div",{class:"stat-icon"}," ðŸ“ ",-1)),t("div",ut,[t("div",pt,o(i.stats.totalProducts),1),t("div",mt,o(a.$t("dashboard.totalProducts")),1)])]),t("div",vt,[s[8]||(s[8]=t("div",{class:"stat-icon"}," âš–ï¸ ",-1)),t("div",yt,[t("div",ft,o(i.compareProducts.length),1),t("div",bt,o(a.$t("dashboard.compareList")),1)])]),t("div",wt,[s[9]||(s[9]=t("div",{class:"stat-icon"}," ðŸ‘ï¸ ",-1)),t("div",Pt,[t("div",It,o(i.stats.watchedProducts),1),t("div",At,o(a.$t("dashboard.watchedProducts")),1)])]),t("div",kt,[s[10]||(s[10]=t("div",{class:"stat-icon"}," ðŸ”¥ ",-1)),t("div",Ct,[t("div",Tt,o(i.topProducts.length),1),t("div",St,o(a.$t("dashboard.hotProducts")),1)])])])]),t("div",Dt,[t("div",Rt,[s[14]||(s[14]=t("div",{class:"chart-header"},[t("h3",{class:"chart-title"}," Price Trend Analysis ")],-1)),t("div",Bt,[i.loadingAnalysis?(c(),d("div",Ft," Loading... ")):i.priceTrend?(c(),d("div",Lt,[t("div",Qt,[t("div",Nt,[s[11]||(s[11]=t("span",{class:"summary-label"},"Average Price",-1)),t("span",qt,"$"+o(i.priceTrend.average_price),1)]),t("div",Et,[s[12]||(s[12]=t("span",{class:"summary-label"},"Price Range",-1)),t("span",jt,"$"+o(i.priceTrend.min_price)+" - $"+o(i.priceTrend.max_price),1)]),t("div",Mt,[s[13]||(s[13]=t("span",{class:"summary-label"},"Trend",-1)),t("span",{class:R(["summary-value",{"trend-up":i.priceTrend.trend==="increasing","trend-down":i.priceTrend.trend==="decreasing","trend-stable":i.priceTrend.trend==="stable"}])},o(i.priceTrend.trend==="increasing"?"â†‘":i.priceTrend.trend==="decreasing"?"â†“":"â†’")+" "+o(i.priceTrend.trend_percentage)+"% ",3)])]),t("div",Ut,[(c(!0),d(I,null,A(i.priceTrend.price_distribution,e=>(c(),d("div",{key:e.range,class:"distribution-item"},[t("span",zt,o(e.range),1),t("div",Vt,[t("div",{class:"dist-fill",style:p({width:`${e.count/i.priceTrend.price_distribution.reduce((b,y)=>b+y.count,0)*100}%`})},null,4)]),t("span",Wt,o(e.count),1)]))),128))])])):(c(),d("div",Ht," No price trend data available "))])]),t("div",Ot,[s[18]||(s[18]=t("div",{class:"chart-header"},[t("h3",{class:"chart-title"}," Data Quality ")],-1)),t("div",Gt,[i.loadingAnalysis?(c(),d("div",Jt," Loading... ")):i.dataQuality?(c(),d("div",Kt,[t("div",Xt,[t("div",Yt,[t("span",Zt,o(i.dataQuality.quality_score),1),s[15]||(s[15]=t("span",{class:"score-label"},"Score",-1))]),t("div",$t,[t("div",xt,[s[16]||(s[16]=t("span",{class:"info-label"},"Total Products",-1)),t("span",ts,o(i.dataQuality.total_products),1)]),t("div",ss,[s[17]||(s[17]=t("span",{class:"info-label"},"Completeness",-1)),t("span",is,o(i.dataQuality.completeness)+"%",1)])])]),i.dataQuality.issues&&i.dataQuality.issues.length>0?(c(),d("div",os,[(c(!0),d(I,null,A(i.dataQuality.issues,e=>(c(),d("div",{key:e.type,class:R(["issue-item",`issue-${e.severity}`])},[t("span",as,o(e.type.replace("_"," ").replace("missing","Missing")),1),t("span",es,o(e.count)+" ("+o(e.percentage)+"%)",1)],2))),128))])):k("",!0)])):(c(),d("div",ns," No quality data available "))])]),t("div",rs,[s[19]||(s[19]=t("div",{class:"chart-header"},[t("h3",{class:"chart-title"}," Category Distribution ")],-1)),t("div",cs,[i.loadingAnalysis?(c(),d("div",ds," Loading... ")):i.categoryDistribution&&i.categoryDistribution.categories?(c(),d("div",ls,[(c(!0),d(I,null,A(i.categoryDistribution.categories.slice(0,5),e=>(c(),d("div",{key:e.name,class:"category-item"},[t("div",hs,[t("span",gs,o(e.name),1),t("span",_s,o(e.count)+" products",1)]),t("div",us,[t("div",{class:"category-fill",style:p({width:`${e.count/i.categoryDistribution.total_products*100}%`})},null,4)]),t("div",ps,[t("span",ms,"Avg: $"+o(e.average_price),1),e.average_rating?(c(),d("span",vs,"Rating: "+o(e.average_rating),1)):k("",!0)])]))),128))])):(c(),d("div",ys," No category data available "))])]),t("div",fs,[t("div",bs,[t("h3",ws,o(a.$t("dashboard.profitDistribution")),1)]),t("div",Ps,[t("div",Is,[t("div",As,[t("span",ks,o(a.$t("dashboard.highProfit")),1),t("div",Cs,[t("div",{class:"profit-fill profit-high",style:p({width:i.getProfitPercentage("high")+"%"})},null,4)]),t("span",Ts,o(i.getProfitCount("high")),1),t("span",Ss,o(a.$t("dashboard.profitBadges.highPotential")),1)]),t("div",Ds,[t("span",Rs,o(a.$t("dashboard.mediumProfit")),1),t("div",Bs,[t("div",{class:"profit-fill profit-medium",style:p({width:i.getProfitPercentage("medium")+"%"})},null,4)]),t("span",Fs,o(i.getProfitCount("medium")),1),t("span",Ls,o(a.$t("dashboard.profitBadges.goodPotential")),1)]),t("div",Qs,[t("span",Ns,o(a.$t("dashboard.lowProfit")),1),t("div",qs,[t("div",{class:"profit-fill profit-low",style:p({width:i.getProfitPercentage("low")+"%"})},null,4)]),t("span",Es,o(i.getProfitCount("low")),1)])])])]),t("div",js,[t("div",Ms,[t("h3",Us,o(a.$t("dashboard.competitionAnalysis")),1)]),t("div",zs,[t("div",Vs,[t("div",Ws,[t("span",Hs,o(a.$t("dashboard.lowCompetition")),1),t("div",Os,[t("div",{class:"competition-fill competition-low",style:p({width:i.getCompetitionPercentage("low")+"%"})},null,4)]),t("span",Gs,o(i.getCompetitionCount("low")),1),t("span",Js,o(a.$t("dashboard.competitionBadges.blueOcean")),1)]),t("div",Ks,[t("span",Xs,o(a.$t("dashboard.mediumCompetition")),1),t("div",Ys,[t("div",{class:"competition-fill competition-medium",style:p({width:i.getCompetitionPercentage("medium")+"%"})},null,4)]),t("span",Zs,o(i.getCompetitionCount("medium")),1),t("span",$s,o(a.$t("dashboard.competitionBadges.competitive")),1)]),t("div",xs,[t("span",ti,o(a.$t("dashboard.highCompetition")),1),t("div",si,[t("div",{class:"competition-fill competition-high",style:p({width:i.getCompetitionPercentage("high")+"%"})},null,4)]),t("span",ii,o(i.getCompetitionCount("high")),1),t("span",oi,o(a.$t("dashboard.competitionBadges.redOcean")),1)])])])])]),t("div",ai,[t("div",ei,[t("div",ni,[s[20]||(s[20]=t("div",{class:"ai-icon"},"ðŸ¤–",-1)),s[21]||(s[21]=t("h3",{class:"ai-title"},"AI Analysis Insights",-1)),!i.loadingAIInsights&&i.aiInsights&&!i.aiInsights.error?(c(),d("button",{key:0,onClick:s[0]||(s[0]=(...e)=>i.loadAIInsights&&i.loadAIInsights(...e)),class:"refresh-btn",title:"Refresh AI insights"}," ðŸ”„ ")):k("",!0)]),t("div",ri,[i.loadingAIInsights?(c(),d("div",ci,[...s[22]||(s[22]=[t("div",{class:"loading-spinner"},null,-1),t("p",null,"Analyzing product data with AI...",-1)])])):i.aiInsights&&i.aiInsights.error?(c(),d("div",di,[t("p",li,"âš ï¸ "+o(i.aiInsights.error),1),t("button",{onClick:s[1]||(s[1]=(...e)=>i.loadAIInsights&&i.loadAIInsights(...e)),class:"retry-btn"}," Retry ")])):i.aiInsights&&i.aiInsights.insights?(c(),d("div",hi,[t("div",{class:"markdown-content",innerHTML:i.formatAIInsights(i.aiInsights.insights)},null,8,gi),i.aiInsights.product_count?(c(),d("div",_i,[t("span",null,"Analyzed "+o(i.aiInsights.product_count)+" products",1)])):k("",!0)])):(c(),d("div",ui,[s[23]||(s[23]=t("p",null,"No AI insights available. Click refresh to generate insights.",-1)),t("button",{onClick:s[2]||(s[2]=(...e)=>i.loadAIInsights&&i.loadAIInsights(...e)),class:"generate-btn"}," Generate Insights ")]))])])]),t("div",pi,[t("div",mi,[t("h3",vi,o(a.$t("dashboard.todayFocus")),1),O(_,{to:"/products",class:"section-link"},{default:G(()=>[P(o(a.$t("dashboard.viewAll")),1)]),_:1})]),t("div",yi,[(c(!0),d(I,null,A(i.topProducts.slice(0,4),e=>(c(),J(u,{key:e.id,product:e,onView:i.viewProduct,onToggleWatch:i.toggleWatch},null,8,["product","onView","onToggleWatch"]))),128))])])])}const Pi=H(x,[["render",fi],["__scopeId","data-v-15d8c42d"]]);export{Pi as default};
