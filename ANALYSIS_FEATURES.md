# 数据分析功能设计

基于当前数据结构，可以实现的分析功能：

## 数据结构分析

### 当前数据字段
- `_id`: MongoDB 唯一标识
- `name`: 产品名称
- `product_url`: 产品链接（完整URL）
- `categories`: 分类数组
- `content_hash`: 内容哈希（用于去重）
- `created_at` / `updated_at`: 时间戳
- `description`: 产品描述
- `image_url`: 图片链接
- `platform`: 平台（amazon等）
- `price`: 价格（字符串格式，如 "$39.99"）
- `rating`: 评分（4.5）
- `review_count`: 评论数（可能为null）
- `review_count_text`: 评论数文本（可能为null）
- `run_id`: 爬取批次ID
- `source_url`: 来源URL
- `status`: 状态（draft等）

## 可实现的分析功能

### 1. 价格分析
- **价格趋势分析**
  - 基于 `created_at` 和 `updated_at` 追踪价格变化
  - 识别价格波动模式
  - 预测价格趋势

- **价格对比**
  - 同类别产品价格对比
  - 跨平台价格对比（如果有多个平台数据）
  - 价格区间分布

- **价格优化建议**
  - 识别定价过高/过低的产品
  - 基于市场平均价格给出建议

### 2. 评分与评论分析
- **评分分析**
  - 平均评分统计
  - 评分分布（高/中/低）
  - 评分趋势（基于时间）

- **评论数分析**
  - 评论数统计（处理 null 值）
  - 评论数与评分的相关性
  - 热门产品识别（高评论数）

- **竞争度评估**
  - 基于评分和评论数计算竞争度
  - 识别蓝海/红海产品

### 3. 分类分析
- **分类分布**
  - 各分类产品数量
  - 分类占比分析
  - 热门分类识别

- **分类趋势**
  - 基于 `run_id` 分析不同爬取批次中的分类变化
  - 识别新兴分类

### 4. 时间序列分析
- **爬取批次分析**
  - 基于 `run_id` 分析不同批次的数据
  - 识别数据更新频率
  - 追踪产品生命周期

- **时间趋势**
  - 产品上架时间分析（基于 `created_at`）
  - 数据更新频率（基于 `updated_at`）
  - 识别新上架产品

### 5. 平台分析
- **平台对比**（如果有多平台数据）
  - 不同平台的价格对比
  - 不同平台的评分对比
  - 平台特色分析

### 6. 产品去重与质量分析
- **去重分析**
  - 基于 `content_hash` 识别重复产品
  - 识别相似产品

- **数据质量分析**
  - 识别缺失字段（如 `review_count` 为 null）
  - 数据完整性评分
  - 数据质量报告

### 7. 利润率分析（需要计算）
- **利润率计算**
  - 基于价格和成本计算利润率
  - 利润率分布
  - 高利润率产品识别

### 8. 竞争分析
- **竞争度评分**
  - 基于评分、评论数、价格计算竞争度
  - 识别低竞争高利润产品（蓝海）
  - 识别高竞争产品（红海）

### 9. 产品推荐分析
- **推荐算法**
  - 基于多个维度（价格、评分、竞争度、利润率）综合评分
  - 识别潜力产品
  - 个性化推荐

### 10. 市场洞察
- **市场趋势**
  - 识别热门产品特征
  - 识别市场空白
  - 预测市场趋势

## 建议实现的优先级

### 高优先级
1. ✅ 价格对比分析（已部分实现）
2. ✅ 评分与评论分析（已部分实现）
3. ✅ 竞争度分析（已部分实现）
4. ⚠️ 价格趋势分析（需要时间序列数据）
5. ⚠️ 分类分析（需要完善分类数据）

### 中优先级
6. 数据质量分析
7. 产品去重分析
8. 平台对比（如果有多个平台）

### 低优先级
9. 市场趋势预测
10. 个性化推荐

## 数据增强建议

### 需要补充的数据
1. **成本数据**：用于计算利润率
2. **库存数据**：用于库存分析
3. **销售数据**：用于销售趋势分析
4. **历史价格**：用于价格趋势分析
5. **竞争对手数据**：用于竞争分析

### 数据优化
1. **价格字段**：建议存储为数字类型，便于计算
2. **review_count**：需要处理 null 值，或从 `review_count_text` 解析
3. **时间字段**：确保时区统一
4. **分类数据**：确保分类标准化

## 实现建议

### 后端 API
- 添加 `/api/analysis/price-trend` 端点
- 添加 `/api/analysis/category-distribution` 端点
- 添加 `/api/analysis/competition-analysis` 端点
- 添加 `/api/analysis/data-quality` 端点

### 前端组件
- 增强 Compare 视图，添加更多对比维度
- 添加 Dashboard 分析图表
- 添加数据质量报告页面
- 添加趋势分析页面

